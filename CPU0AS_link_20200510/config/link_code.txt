/
os_start:
LD R1, R0, OS_current
LDR SP, R0, R1
POP R1
POP R2
POP R3
POP R4
POP R5
POP R6
POP R7
POP R8
POP R9
POP R10
POP R11
POP SW
POP LR
PUSH LR

/
push_all:
PUSH LR
PUSH SW
PUSH R11
PUSH R10
PUSH R9
PUSH R8
PUSH R7
PUSH R6
PUSH R5
PUSH R4
PUSH R3
PUSH R2
PUSH R1
PUSH LR

/
pop_all:
POP R1
POP R2
POP R3
POP R4
POP R5
POP R6
POP R7
POP R8
POP R9
POP R10
POP R11
POP SW
POP LR
PUSH LR

/
set_os_sp:
MOV R8, SP
LD R10, R0, OS_current
STR R8, R0, R10

/
set_cpu_sp:
LD R10, R0, OS_current
LDR SP, R0, R10
